/*
with utilizados as (
	select distinct pb.codproduto
	from tblnegocioprodutobarra item
	inner join tblprodutobarra pb on (pb.codprodutobarra = item.codprodutobarra)
	union
	select distinct pb.codproduto
	from tblnotafiscalprodutobarra item
	inner join tblprodutobarra pb on (pb.codprodutobarra = item.codprodutobarra)
	union
	select distinct pb.codproduto
	from tblcupomfiscalprodutobarra item
	inner join tblprodutobarra pb on (pb.codprodutobarra = item.codprodutobarra)
	union
	select distinct pb.codproduto
	from tblnfeterceiroitem item
	inner join tblprodutobarra pb on (pb.codprodutobarra = item.codprodutobarra)
)
select * 
from tblproduto p
where p.codproduto not in (select u.codproduto from utilizados u )
and (p.criacao is null or p.criacao <= '2017-12-31 23:59:59')

*/

/*
delete from tblestoquemovimento where codestoquesaldoconferencia in (
    select codestoquesaldoconferencia from tblestoquesaldoconferencia where codestoquesaldo in (212484)
)

delete from tblestoquesaldoconferencia where codestoquesaldo in (74517)

delete from tblestoquemovimento where codestoquemes = 1047584
*/


--select * from tblestoquemovimentotipo 

/*
delete from tblestoquemovimento where codestoquemovimento in (
select mov.codestoquemovimento
from tblprodutovariacao pv 
inner join tblestoquelocalprodutovariacao elpv on (pv.codprodutovariacao = elpv.codprodutovariacao)
inner join tblestoquesaldo es on (es.codestoquelocalprodutovariacao = elpv.codestoquelocalprodutovariacao)
inner join tblestoquemes mes on (mes.codestoquesaldo = es.codestoquesaldo)
inner join tblestoquemovimento mov on (mov.codestoquemes = mes.codestoquemes)
where mov.codestoquemovimentotipo not in (4101, 4201)
and pv.codproduto in (
*/
--delete from tblprodutobarra where codproduto in (
--delete from tblprodutovariacao where codproduto in (
--delete from tblprodutoembalagem where codproduto in (
delete from tblproduto where codproduto in (
 930850
, 26241
, 26242
, 26243
, 26245
, 26246
, 26244
, 26469
, 308479
, 100138
, 109623
, 317233
, 100341
, 2592
, 7057
, 303248
, 301843
, 303438
, 301852
, 305996
, 302304
, 303551
, 301371
, 301440
, 303689
, 301621
, 302845
, 301432
, 301447
, 301658
, 301221
, 300704
, 303559
, 306237
, 301661
, 305978
, 303970
, 303971
, 302300
, 303558
, 302309
, 300807
, 304064
, 23402
, 303552
, 301373
, 302096
, 303555
, 300713
, 301845
, 300978
, 301871
, 301226
, 302530
, 304996
, 301225
, 304719
, 302520
, 302519
, 300983
, 300715
, 305988
, 303966
, 303965
, 303556
, 303557
, 305979
, 303587
, 303588
, 303590
, 301370
, 304993
, 303964
, 305994
, 302301
, 305992
, 304994
, 303967
, 302533
, 302295
, 301623
, 303069
, 300871
, 303968
, 20730
, 302656
, 303075
, 301687
, 302532
, 302527
, 301660
, 302305
, 304846
, 301023
, 301365
, 302297
, 301209
, 301442
, 303554
, 301172
, 307830
, 307603
, 307602
, 307605
, 307604
, 302655
, 302462
, 307606
, 307795
, 300465
, 300589
, 301156
, 300477
, 302461
, 302535
, 300067
, 302154
, 301175
, 301056
, 27773
, 303233
, 301429
, 102434
, 9802
, 15180
, 15177
, 305614
, 10006
, 10003
, 15178
, 6535
, 305615
, 305612
, 305613
, 8506
, 8500
, 8499
, 302407
, 302410
, 302409
, 302401
, 303083
, 300779
, 15165
, 15167
, 5082
, 300774
, 6534
, 6800
, 6794
, 2541
, 8952
, 8947
, 305911
, 5087
, 300778
, 5067
, 6527
, 8511
, 6797
, 7632
, 8953
, 15163
, 8496
, 8570
, 109867
, 28043
, 200003
, 200111
, 200117
, 200126
, 200162
, 200219
, 200220
, 200227
, 200241
, 200242
, 200293
, 24752
, 6469
, 18359
, 301213
, 303415
, 3967
, 303413
, 2254
, 3928
, 305746
, 2237
, 2244
, 3930
, 306309
, 6673
, 6672
, 3436
, 3861
, 306401
, 301131
, 316114
, 300096
, 302594
, 302595
, 304507
, 301718
, 302076
, 2291
, 300097
, 300865
, 301186
, 301185
, 301600
, 304003
, 300523
, 300520
, 300519
, 302558
, 301972
, 300144
, 300517
, 300864
, 302577
, 304001
, 303999
, 300255
, 300515
, 303354
, 300855
, 8280
, 658
, 2014
, 2572
, 4026
, 301197
, 300513
, 302342
, 2940
, 304000
, 646
, 304445
, 301977
, 304454
, 300504
, 307697
, 655
, 1710
, 302351
, 302352
, 15013
, 8924
, 3237
, 2301
, 300811
, 3249
, 300707
, 300535
, 301426
, 300087
, 300283
, 300063
, 301401
, 304737
, 300810
, 300809
, 1964
, 1970
, 1966
, 302658
, 304736
, 301877
, 306144
, 302498
, 301118
, 301448
, 303286
, 302059
, 7958
, 306323
, 301882
, 300808
, 304203
, 300628
, 302075
, 301638
, 302346
, 306322
, 301644
, 306143
, 301880
, 301639
, 301003
, 300603
, 300061
, 301402
, 314565
, 304472
, 304473
, 304475
, 302336
, 301597
, 301595
, 300863
, 304449
, 302326
, 611
, 302324
, 303360
, 303457
, 302331
, 301948
, 301949
, 304444
, 304007
, 301975
, 302328
, 300524
, 300858
, 609
, 305068
, 301593
, 301599
, 304441
, 2937
, 302556
, 107999
, 614
, 623
, 301596
, 1711
, 652
, 616
, 8270
, 304450
, 304456
, 304452
, 304448
, 303351
, 304465
, 637
, 618
, 617
, 304461
, 2143
, 301973
, 300508
, 302041
, 303502
, 610
, 300525
, 100809
, 301196
, 640
, 5918
, 4508
, 304447
, 2561
, 1713
, 100782
, 306263
, 302576
, 303746
, 303747
, 2331
, 16092
, 17199
, 2140
, 303068
, 1385
, 2144
, 2146
, 2141
, 2148
, 2576
, 317935
, 933298
, 2136
, 2376
, 604
, 8260
, 7019
, 16284
, 7030
, 7020
, 7021
, 7045
, 16280
, 7026
, 63
, 64
, 883
, 100593
, 307042
, 305869
, 306026
, 305325
, 15471
, 13011
, 302245
, 305327
, 314435
, 2153
, 302531
, 108051
, 306465
, 306464
, 304266
, 7265
, 8121
, 8122
, 7264
, 932835
, 300683
, 2103
, 300082
, 300081
, 306111
, 301993
, 303731
, 303730
, 304011
, 305889
, 304622
, 306614
, 303605
, 304619
, 17163
, 104295
, 15488
, 109124
, 102741
, 4717
, 302638
, 303287
, 302869
, 302637
, 10348
, 2961
, 100465
, 23550
, 9502
, 307024
, 301532
, 301525
, 300485
, 10340
, 7809
, 2597
, 304652
, 1983
, 244
, 300195
, 301927
, 304648
, 301527
, 302063
, 302007
, 300597
, 301747
, 300599
, 301750
, 301524
, 301746
, 302083
, 4437
, 301749
, 302441
, 301745
, 301900
, 302616
, 2491
, 2492
, 300468
, 300467
, 300469
, 304646
, 301922
, 4770
, 301522
, 303384
, 307027
, 4134
, 301582
, 301528
, 3437
, 2959
, 302442
, 302989
, 301742
, 301517
, 300604
, 36
, 2595
, 301531
, 304655
, 304521
, 304527
, 306466
, 304540
, 300496
, 304528
, 304542
, 302303
, 302306
, 304526
, 303976
, 304060
, 2383
, 2477
, 15016
)
--)